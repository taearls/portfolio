# Cloudflare Workers configuration for Feature Flags API
# See: https://developers.cloudflare.com/workers/wrangler/configuration/
name="feature-flags"

main = "src/index.ts"
compatibility_date = "2025-02-04"
compatibility_flags = ["nodejs_compat"]

# Observability configuration
[observability]
enabled = true

# Environment variables (set via dashboard or wrangler secret)
# ADMIN_API_KEY - set via: wrangler secret put ADMIN_API_KEY
# ALLOWED_ORIGINS - comma-separated list of allowed origins

[env.production]
name = "feature-flags"
kv_namespaces = [
  { binding = "FEATURE_FLAGS_KV", id = "55a586e168e54566bcfb0a1e6dd11f88" }
]
vars = { ALLOWED_ORIGINS = "https://tylerearls.com" }

[env.staging]
name = "feature-flags-staging"
kv_namespaces = [
  { binding = "FEATURE_FLAGS_KV", id = "55a586e168e54566bcfb0a1e6dd11f88", preview_id = "YOUR_PREVIEW_KV_NAMESPACE_ID" }
]
vars = { ALLOWED_ORIGINS = "https://staging.tylerearls.com,http://localhost:3000,http://localhost:4173" }

# Build configuration
[build]
command = "npm install && npm run build"

# Local development configuration
[dev]
port = 8787

